<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Missing Pieces: Understanding Overdoses Beyond the Statistics</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    
    <!-- HOOK -->
    <section id="hero" class="section">
      <div class="hero-inner">
        <h1 id="typewriter" class="hero-title"></h1>
        <p id="hero-subtext" class="hero-subtext"></p>
    
        <div class="hero-actions">
          <button id="skip-intro" class="hero-button">Skip intro</button>
          <a href="#section2" class="hero-button hero-button-outline">
            Begin the story
          </a>
        </div>
      </div>
    </section>
    

    <section class="section" id="section2">
      <div class="content">
        <h1>The Global Surge</h1>
        <p>The countries with the highest overdose and drug-related death rates per 1 million people in 2022. Top 10 countries with the highest rates are shown in red.</p>
      </div>
      <div class="global-surge-container">
        <div class="global-surge-left">
          <div class="bar-chart-container">
            <div id="overdose-bar-chart"></div>
          </div>
        </div>
        <div class="global-surge-right">
          <div class="map-container">
            <iframe src="visualizations/world_tour_data/world_tour_interactive.html" width="100%" height="100%" style="border:none;"></iframe>
          </div>
          <div id="country-context" class="country-context">
            <span id="country-rate">324 deaths for every 1 million people</span>
          </div>
        </div>
      </div>
      <script src="https://d3js.org/d3.v7.min.js"></script>
      <script src="visualizations/global-bar-chart.js"></script>
    </section>

   <section class="section" id="section-quiz">
    <div class="content">
      <h1>Test Your Knowledge</h1>
      <p>What percentage of people have used illicit drugs? Note: Illicit drug use includes the use of marijuana, cocaine, heroin, hallucinogens, inhalants, and methamphetamine, as well as the misuse of prescription drugs (pain relievers, tranquilizers, stimulants, or sedatives)</p>
    </div>

    <div id="quiz-container">
      <div id="quiz-inputs">
      <div class="input-box">
        <label><strong>Lifetime Use</strong></label>
        <div>
          <input type="number" id="lifetime-guess" min="0" max="100" step="0.1" placeholder="0">
          <span>%</span>
        </div>
      </div>
      <div class="input-box">
        <label><strong>Past Year Use</strong></label>
        <div>
          <input type="number" id="pastyear-guess" min="0" max="100" step="0.1" placeholder="0">
          <span>%</span>
        </div>
      </div>
      <div class="input-box">
        <label><strong>Past Month Use</strong></label>
        <div>
          <input type="number" id="pastmonth-guess" min="0" max="100" step="0.1" placeholder="0">
          <span>%</span>
        </div>
      </div>
    </div>

      <div id="pie-charts"></div>

      <div id="quiz-buttons">
        <button id="reveal-answer" class="quiz-button">Reveal Actual Percentages</button>
        <button id="try-again" class="quiz-button" style="display: none;">Try Again</button>
      </div>
    </div>

    <link rel="stylesheet" href="visualizations/drug-quiz/drug-quiz.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="visualizations/drug-quiz/drug-quiz.js"></script>
  </section>


    <section class="section" id="section2b">
      <div class="content">
        <h1>Contextualizing the Crisis</h1>
        <p>Brief overview of global overdose rates over time based on age group. </p>
      </div>

      <div id="container">
        <div id="overdose-line-chart"></div>
      </div>

      <div id="tooltip"></div>
      <script src="https://d3js.org/d3.v7.min.js"></script>
      <script src="visualizations/age-line-chart/age-line-chart.js"></script>
    </section>


    <!-- RISING INSIGHTS -->
    <section class="section" id="section3">
        <div class="content">
          <h1>Zooming In: The U.S. Perspective</h1>
          <p>Explore the difference in fatal overdose rates around the United States in 2023.</p>
        </div>
        <div id="us-overdose-map"></div>
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
        <script src="visualizations/us-choropleth/us-overdose-map.js"></script>
      </section>

  <!-- EMPLOYMENT AND ADDICTION -->
  <section class="section" id="section3a">
    <div class="content">
      <h1>Addiction Across Industries</h1>
      <p>This visualization reveals how addiction rates differ across industries, illustrating how factors such as workplace stress, physical demands, and job culture can influence substance use patterns.</p>
      <div id="industryIcons"></div>
    </div>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="visualizations/employment_addiction/employment_addiction.js"></script>
  </section>
      

<section class="section" id="section3b">
  <div class="content">
    <h1>Substances Driving the Crisis</h1>
    <p>Each circle represents a drug, sized by its contribution to nonfatal overdoses per 100,000 ED visits in 2024. Hover to learn more about each substance.</p>
  </div>

  <div id="drug-bubble-chart" style="width: 80%; display: flex; justify-content: center; align-items: center; flex-direction: column;"></div>
  <!-- Load the bubble chart visualization -->
  <script src="visualizations/drug-types-bubbles/drug-bubble-chart.js"></script>
</section>

    <!-- HUMAN STORIES GALLERY -->
    <section class="section" id="human-stories">
      <div class="content">
        <h1>Stories Behind the Numbers</h1>
        <p>Navigate through personal stories showing human impact of the overdose crisis.</p>
      </div>
      
      <div class="story-gallery">
        <div class="story-container">
          <!-- Jonathan's Story -->
          <div class="story-slide active" data-story="0">
            <div class="story-wrapper">
              <div class="story-left">
                <img src="data/jonathans_story.png" alt="Jonathan's Story" class="story-image">
                <div class="story-controls">
                  <h2>Jonathan's Story</h2>
                  <button class="play-btn" data-audio="jonathans-audio">â–¶ Play Story</button>
                </div>
                <audio id="jonathans-audio" src="data/jonathans_story.mp3"></audio>
              </div>
              <div class="story-right">
                <div class="transcript-container">
                  <h3>Transcript</h3>
                  <div class="transcript" id="jonathans-transcript">
                    <p class="transcript-line" data-time="0">He was the son that any mother would have wanted her son to grow up to be.</p>
                    <p class="transcript-line" data-time="5">Unfortunately, we still don't know what makes someone vulnerable to develop addiction.</p>
                    <p class="transcript-line" data-time="12">He deserved to live a life like any of us.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sofia's Story -->
          <div class="story-slide" data-story="1">
            <div class="story-wrapper">
              <div class="story-left">
                <img src="data/sofias_story.png" alt="Sofia's Story" class="story-image">
                <div class="story-controls">
                  <h2>Sofia's Story</h2>
                  <button class="play-btn" data-audio="sofias-audio">â–¶ Play Story</button>
                </div>
                <audio id="sofias-audio" src="data/sofias_story.mp3"></audio>
              </div>
              <div class="story-right">
                <div class="transcript-container">
                  <h3>Transcript</h3>
                  <div class="transcript" id="sofias-transcript">
                    <p class="transcript-line" data-time="0">Bored in my room and I notice, you know, I have half this pill.</p>
                    <p class="transcript-line" data-time="4">Why not? It'll make me cheer up.</p>
                    <p class="transcript-line" data-time="9">And I crushed it up, took a line...</p>
                    <p class="transcript-line" data-time="12">Felt kind of sparkly for two seconds and then I woke up in the hospital.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Jake's Story -->
          <div class="story-slide" data-story="2">
            <div class="story-wrapper">
              <div class="story-left">
                <img src="data/jakes_story.png" alt="Jake's Story" class="story-image">
                <div class="story-controls">
                  <h2>Jake's Story</h2>
                  <button class="play-btn" data-audio="jakes-audio">â–¶ Play Story</button>
                </div>
                <audio id="jakes-audio" src="data/jakes_story.mp3"></audio>
              </div>
              <div class="story-right">
                <div class="transcript-container">
                  <h3>Transcript</h3>
                  <div class="transcript" id="jakes-transcript">
                    <p class="transcript-line" data-time="0">Told my dad hey, like, I already have fentanyl.</p>
                    <p class="transcript-line" data-time="2">I'm gonna either use it in the house or I'm going to use it outside of the house.</p>
                    <p class="transcript-line" data-time="5">And, um, very luckily, he let me come in the house.</p>
                    <p class="transcript-line" data-time="8">It would have been extremely bad if he didn't because I overdosed that night.</p>
                    <p class="transcript-line" data-time="12">My heart stopped and I went blue.</p>
                    <p class="transcript-line" data-time="14">My dad had to do CPR on me. My mom had to call the ambulance.</p>
                    <p class="transcript-line" data-time="20">I can't imagine how traumatic that was for them.</p>
                    <p class="transcript-line" data-time="23">[Interviewer] I feel, I feel terrible for your parents.</p>
                    <p class="transcript-line" data-time="26">I can't even imagine...I feel so bad that I did that to them.</p>
                    <p class="transcript-line" data-time="29">So, I went to the hosipital again that night. Got out, relapsed the same day again.</p>
                    <p class="transcript-line" data-time="36">I didn't want to stay sober whatsoever.</p>
                    <p class="transcript-line" data-time="38">So, I would just tell the doctors, "Yeah, I'm going to stay on suboxone and not relapse."</p>
                    <p class="transcript-line" data-time="45">I'd get out and the same day I'd relapse. It kept going on like that for a while.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="story-navigation">
          <button class="nav-btn prev-btn" id="prev-story">â€¹</button>
          <div class="story-indicators">
            <span class="story-dot active" data-story="0"></span>
            <span class="story-dot" data-story="1"></span>
            <span class="story-dot" data-story="2"></span>
          </div>
          <button class="nav-btn next-btn" id="next-story">â€º</button>
        </div>
      </div>
    </section>

 
    <!-- SECTION 7 (NALAXONE DISTRIBUTION) -->
    <section class="section" id="section7">
      <div class="content">
        <h1>Recent Rise of Naloxone in U.S.</h1>
        <p>Naloxone distribution has increased across various prescribing specialties in recent years, reflecting a growing effort to combat the overdose crisis.</p>
      </div>
      <div id="naloxone-flex" class="pair-flex">
        <div id="naloxone-bar" class="pair-viz"></div>
        <div id="naloxone-line" class="pair-viz"></div>
        <div id="naloxoneYearOverlay" class="year-overlay"></div>
      </div>
    </section>
    <script src="visualizations/naloxone_distribution/bar_and_line_graph.js"></script>

    <!-- â­ NEW NALOXONE QUIZ SECTION (INSERTED HERE) -->
    <section class="section" id="naloxone-quiz-section">
      <div class="content">
        <h1>What Percent of Americansâ€¦</h1>
        <!-- <p>Hover over each chart to make your guess, then submit to reveal the truth.</p> -->
      </div>

      <div id="naloxone-quiz-container"></div>

      <div style="text-align:center; margin-top:30px;">
        <button id="submit-quiz" class="hero-button">Reveal the Answers</button>
      </div>

      <script src="visualizations/naloxone-quiz/naloxonequiz.js"></script>
    </section>

    <!-- SECTION 8 AND REST OF DOCUMENT CONTINUE UNCHANGED -->
    <!-- ... -->

    <!-- SOLUTION -->
    <section class="section" id="section8">
      <div class="content">
        <h1>Solutions in Focus</h1>
        <p>Explore small-scale but effective community-based programs across the United States that are making a real difference in preventing overdose deaths and supporting recovery.</p>
      </div>
      <div class="solutions-container">
        <div class="plot-container">
          <iframe
            src="visualizations/solution_in_focus/solution_in_focus.html"
            width="100%" height="580"
            style="border:none; display:block;">
          </iframe>
        </div>
        <div class="solutions-text-box" id="solutions-info">
          <h3>Key Insights</h3>
          <p>Click on any program marker on the map to view detailed information about community-based interventions.</p>
        </div>
      </div>
    </section>
    <script>
      window.addEventListener('message', (event) => {
        if (event.data.type === 'programSelected') {
          const d = event.data.data;
          document.getElementById('solutions-info').innerHTML = `
            <h3>${d.name}</h3>
            <p class="location">${d.city}</p>
            <p class="metric">${d.metric}</p>
            <p class="description">${d.blurb}</p>
            <p class="impact-title">Community Impact:</p>
            <p class="impact">${d.efforts}</p>
          `;
        } else if (event.data.type === 'programReset') {
          document.getElementById('solutions-info').innerHTML = `
            <h3>Key Insights</h3>
            <p>Click on any program marker on the map to view detailed information about community-based interventions.</p>
          `;
        }
      });
    </script>

    <!-- <section class="section" id="section8">
      <div class="content">
        <h1>Scaling What Works</h1>
        <p>Zoom in on promising interventions and generalize strategies for broader implementation.</p>
      </div>
    </section> -->

    <!-- REFERENCES -->
    <!-- <section class="section" id="section9">
      <div class="content">
        <h1>Additional Resources</h1>
        <p>Explore access to rehabilitation programs, Naloxone distribution networks, and educational outreach initiatives.</p>
      </div>
    </section> -->

    <section class="section" id="section11">
      <div class="content">
        <h1>Works Cited</h1>
        <p>Data from WHO, CDC, NIH, and Global Drug Observatory.</p>
      </div>
    </section>
  </div>

  <!-- Scroll Indicators -->
  <nav class="scroll-indicators">
    <a href="#section1" class="indicator active"></a>
    <a href="#section2" class="indicator"></a>
    <a href="#section3" class="indicator"></a>
    <a href="#section4" class="indicator"></a>
    <a href="#section5" class="indicator"></a>
    <a href="#section6" class="indicator"></a>
    <a href="#section7" class="indicator"></a>
    <a href="#section8" class="indicator"></a>
    <a href="#section9" class="indicator"></a>
    <a href="#section10" class="indicator"></a>
    <a href="#section11" class="indicator"></a>
  </nav>

  <script src="script.js"></script>
  <!-- ðŸ‘‡ Add your typewriter script here -->
  <script src="visualizations/hero-typewriter/heroTypewriter.js"></script>
</body>
</html>